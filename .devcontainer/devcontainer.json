// For format details, see https://aka.ms/devcontainer.json. For config options, see the
{
	"name": "${localWorkspaceFolderBasename}-dev",

	"build": {
		"dockerfile": "Dockerfile",
		"context": "."
	},

	"runArgs": [
		"--tmpfs",
		"/tmp:exec"
	],

	"mounts": [
		// Mount the local timezone to the container to ensure correct time settings.
		"source=/etc/timezone,target=/etc/timezone,readonly,type=bind",
		"source=/etc/localtime,target=/etc/localtime,readonly,type=bind"
	],

	"remoteUser": "dev",

	"workspaceMount": "source=${localWorkspaceFolder},target=/code/${localWorkspaceFolderBasename},type=bind",

	"workspaceFolder": "/code/${localWorkspaceFolderBasename}",

	// Bootstrap vcpkg automatically on container creation
	"postCreateCommand": "bash -c 'git submodule update --init --recursive && if [ ! -f ./external/vcpkg/vcpkg ]; then ./external/vcpkg/bootstrap-vcpkg.sh -disableMetrics || exit 1; fi'",

	// Container environment variables
	"containerEnv": {
		"VCPKG_ROOT": "${containerWorkspaceFolder}/external/vcpkg",
		"VCPKG_BINARY_SOURCES": "clear;files,${containerWorkspaceFolder}/vcpkg/cache,readwrite"
	},

	// Configure tool-specific properties.
	"customizations": {

		// Configure properties specific to VS Code.
		"vscode": {

			// Add the IDs of extensions you want installed when the container is created.
			"extensions": [
				"ms-vscode.cpptools-extension-pack"
			]
		}
	}
}
